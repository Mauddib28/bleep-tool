# Analysis Mode

## Overview

The Analysis mode in BLEEP is designed to post-process JSON dumps generated by the explore command. This mode allows you to extract insights, summarize device characteristics, and analyze the structure of Bluetooth Low Energy (BLE) devices offline.

## Command Syntax

```bash
python -m bleep.cli analyse|analyze <JSON_FILES> [options]
```

> Note: Both British (`analyse`) and American (`analyze`) spellings are supported.

### Required Arguments

- `JSON_FILES`: One or more JSON files generated by the explore command

### Options

- `--detailed`, `-d`: Show detailed analysis including characteristics, handles, flags, and descriptors

## Examples

### Basic Usage

```bash
# Analyze a single JSON dump
python -m bleep.cli analyse device_dump.json

# Analyze multiple JSON dumps
python -m bleep.cli analyse dump1.json dump2.json dump3.json
```

### Detailed Analysis

```bash
# Show detailed information about services and characteristics
python -m bleep.cli analyse device_dump.json --detailed
```

## Output Format

### Basic Output

The basic output provides a summary of the device, including:

- Device name and address
- Number of services
- Number of characteristics

Example:
```
[*] Summary for device_dump.json
  Device: My Device (AA:BB:CC:DD:EE:FF)
  Services: 5
  Characteristics: 12
```

### Detailed Output

The detailed output (`--detailed` flag) provides comprehensive information about the device's GATT structure, including:

- Device name and address
- Services with UUIDs and paths
- Characteristics with UUIDs, handles, and flags
- Descriptors with UUIDs

Example:
```
[*] Summary for device_dump.json
  Device: My Device (AA:BB:CC:DD:EE:FF)
  Services: 5
  Characteristics: 12

  Service: 00001801-0000-1000-8000-00805f9b34fb
    Path: /org/bluez/hci0/dev_AA_BB_CC_DD_EE_FF/service0001
    Characteristic: 00002a05-0000-1000-8000-00805f9b34fb
      Handle: 0x0002
      Flags: indicate
      Descriptors: 1
        00002902-0000-1000-8000-00805f9b34fb

  Service: 0000180a-0000-1000-8000-00805f9b34fb
    Path: /org/bluez/hci0/dev_AA_BB_CC_DD_EE_FF/service000a
    Characteristic: 00002a29-0000-1000-8000-00805f9b34fb
      Handle: 0x002b
      Flags: read
    ...
```

## Supported JSON Formats

The analysis mode supports two JSON formats:

1. **Explore Command Format** (Recommended)
   - Generated by the `explore` command
   - Contains a "device" object with "services" array

2. **Legacy Format**
   - Contains a top-level "Services" object
   - Used by older versions of BLEEP

## Use Cases

### Device Comparison

Compare multiple device dumps to identify differences in services and characteristics:

```bash
python -m bleep.cli analyse device1.json device2.json --detailed
```

### Offline Analysis

Analyze device structures without requiring the physical device to be present:

```bash
python -m bleep.cli analyse device_dump.json --detailed > analysis_report.txt
```

### Integration with Other Tools

The analysis mode can be used as part of a larger workflow:

1. Scan devices with the explore command
2. Analyze the JSON dumps with the analyse command
3. Use the results for further processing or reporting

## Related Commands

- [Explore Mode](explore_mode.md): Generate JSON dumps for analysis
- [AOI Mode](aoi_mode.md): Assets-of-Interest analysis for security research
